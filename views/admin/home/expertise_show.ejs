<style>
td,th {
    padding: 10px;
}
</style>
<%- include('../../common/header') %>
<% if(msg) { %> <%= msg %><% } %>
<section class="center-wr" style="margin-top:77px !important;">
<div class="row page-wraper">
  <div class="col-md-12 full-content-wraper">
    <div class="title-header"><h1 class="cmn-heading"><%= title.replace(/\w/, c => c.toUpperCase()) %></h1></div>
    <% if(msg) { %> <div  class="alert alert-success" id="alertmsg" ><span class="cmn-message"><%= msg %></span></div><% } %>
        <span><button class="cmn-btn btn-show-hide"><a href="javascript:void(0);" style="float:right" id="expertisemainform" data-target="#expertisemainmodel">Add Expertise</a></button></sapn>
        <span><button class="cmn-btn btn-show-hide" data-target="#expertisemodel"><a href="javascript:void(0);" id="expertiseform" style="float:right;">Add Item</a></button></span>
        <span><button class="cmn-btn btn-show-hide" data-target="#expertiselistmodel"><a href="javascript:void(0);" id="expertiselistform" style="float:right;">Expertise List</a></button></span>
    <div class="col-md-2  sidebar-menu">
    <%- include('../../common/sidebar_common') %>
    </div>
     <div class="col-md-5 content-wraper"> 
    <h1><% if (pagedata) { %><%= pagedata.title %>  <% } %></h1>
    <br>
    <h3><% if (pagedata) { %><%= pagedata.name %>  <% } %></h3>
    <br>
    <% if (pagedata) { %> <%= pagedata.description %>  <% } %>


<hr>
<h1>Expertise Items</h1>
<br>
<table border="2" cellspacing="5" cellpadding="5" style="width: 100%;">
<tr>
<th>Title</th>
<th>Name</th>
<th>Edit</th>
<th>Remove</th>
</tr>
<% for(var item of expertiseitem) { %>
   <tr><td> 
      <%= item.name %>
      </td>
      <td> 
      <%= item.description %>
      </td>
       <td> 
      <a href="javascript:void(0)"  onclick="getexpertiseedit('<%= item._id %>')">Edit</a>
      </td> 
      <td> 
      <a href="/expertiseitemremove/<%= item._id %>" onclick="return confirm('Are you sure you want to delete this item')">X</a>
      </td>
      </tr>
<% } %>
</table>

<hr>
<h1>Expertise List</h1>
<br>
<table border="2" cellspacing="5" cellpadding="5" style="width: 100%;">
<tr>
<th>Name List</th>
<th>Remove</th>
</tr>
<% for(var list of expertiseitemlist) { %>
   <tr><td> 
      <%= list.name %>
      </td>
      <td> 
      <a href="/expertiselistremove/<%= list._id %>" onclick="return confirm('Are you sure you want to delete this list item')">X</a>
      </td>
      </tr>
<% } %>
</table>

</div>
<div class="col-md-3 form-wraper" style="display: none;" id="form-wrapper-form">
   <div id="firstmainform" style="display: none;">
    <h3>Expertise</h3>
    <form method="POST" action="/expertise" class="common-form">
      <label>Title:<input type="text" name="title" required></label>
      <br>
      <label>Name:<input type="text" name="name" required></label>
      <br>
      <label>Description:<br><textarea name="description"></textarea></label>
      <br>
      <br>
      <input type="submit" value="Submit">
    </form>
  </div>

   <div id="seconditemform" style="display: none;">
    <h3>Expertise Item </h3>
    <form method="POST" action="/expertiseitem" enctype="multipart/form-data">
      <label>Name:<input type="text" name="name"  required></label>
      <br>
      <label>Description:<input type="text" name="description" required></label>
      <br>
      <input type="file" name="userPhoto"  onchange="readURL('create',this);" id="userPhoto" placeholder=""  style="border:none;width:100%;" accept="image/*">
      <img id="create-show-image" src="/images/user.png" alt="your image" width="100px" height="100px" />
      <br>
      <br>
      <input type="submit" value="Submit">
  </form>
  </div>

  <div id="edititemform" style="display: none;">
    <h3>Expertise Item update</h3>
    <form method="POST" action="/expertiseitemedit" enctype="multipart/form-data">
       <input type="hidden" name="editid" id="editid"/>
      <label>Name:<input type="text" name="name" id="name"  required></label>
      <br>
      <label>Description:<input type="text" id="description" name="description" required></label>
      <br>
      <input type="hidden" name="oldimage" id="oldfile">
      <input type="file" name="userPhoto"  onchange="readURL('update',this);" id="userPhotoupdate" style="border:none;width:100%;" accept="image/*">
      <img id="show-image" src="#" alt="your image" width="100px" height="100px"/>
      <br>
      <br>
      <input type="submit" value="Update">
  </form>
  </div>

  <div id="expertiselist" style="display: none;">
    <h3>Expertise List</h3>
    <form method="POST" action="/expertiselistitem">
      <label>Name:<input type="text" name="name" id="name"  required></label>
      <br>
      <label>Description:<input type="text" name="description" ></label>
      <br>
      <br>
      <input type="submit" value="Add List">
  </form>
  </div>

</div>
  </div>
</div> 
</section>
<script>
  $('#expertisemainform').click(function(){
    
      $('#form-wrapper-form').show();
      $('#firstmainform').toggle();
      $('#seconditemform').hide();
      $('#edititemform').hide();
      $('#userPhoto').val("");
      $('#userPhotoupdate').val("");
      
  })

  $('#expertiseform').click(function(){
    
      $('#form-wrapper-form').show();
      $('#firstmainform').hide();
      $('#seconditemform').toggle();
      $('#edititemform').hide();
      $('#userPhotoupdate').val("");

  })

  $('#expertiselistform').click(function(){
     
    $('#form-wrapper-form').show();
    $('#expertiselist').toggle();
    $('#firstmainform').hide();
    $('#seconditemform').hide();
    $('#edititemform').hide();
    $('#userPhotoupdate').val("");

  })


  function getexpertiseedit(editid){
    
    $.ajax({
    url:"/getexpertiseitem/"+editid,
    method:"GET",
    success: function(response){

       $('#userPhoto').val("");
       $('#editid').val(editid);
       $('#name').val(response.name);
       $('#description').val(response.description);
       $('#oldfile').val(response.image);
       if(response.image != ''){
        $('#show-image').attr('src', response.image).width(100).height(100); 
       }else{
        $('#show-image').attr('src', '/images/user.png').width(100).height(100); 
       }
       $('#firstmainform').hide();
       $('#form-wrapper-form').show();
       $('#edititemform').show();
       $('#seconditemform').hide();
       
      }
    });
    return false;
}

function readURL(ftype,input) {
  if (input.files && input.files[0]) {
    var reader = new FileReader();
    
    reader.onload = function (e) {
      $('#show-image').attr('src', e.target.result).width(100).height(100);
      $('#create-show-image').attr('src', e.target.result).width(100).height(100);
    };

    reader.readAsDataURL(input.files[0]);
  }
}

</script>
