<style>
td,th {
    padding: 10px;
}
.cmn-btn{
  margin-left: 2%;
}
</style>
<%- include('../../common/header') %>
<section class="center-wr" style="margin-top:77px;">
<div class="row page-wraper">
  <div class="col-md-12 full-content-wraper">
    <div class="title-header"><h1 class="cmn-heading"><%= title.replace(/\w/, c => c.toUpperCase()) %></h1></div>
    <% if(msg) { %> <div  class="alert alert-success" id="alertmsg" ><span class="cmn-message"><%= msg %></span></div><% } %>
        <span><button class="cmn-btn btn-show-hide"><a href="javascript:void(0);" id="clientmainformbtn" style="float:right">Add Project</a></button></sapn>
    <span><button class="cmn-btn btn-show-hide"><a href="javascript:void(0);" id="clientprojectformbtn" style="float:right;">Add Item</a></button></span>
     <span><button class="cmn-btn btn-show-hide"><a href="javascript:void(0);" id="csliderformbtn" style="float:right;">Add Slider</a></button></span>
    <div class="col-md-2  sidebar-menu">
    <%- include('../../common/sidebar_common') %>
    </div>
     <div class="col-md-5 content-wraper"> 
    <h1><% if(pagedata) { %><%= pagedata.title %><% } %></h1>
    <br>
    <h3><% if(pagedata) { %><%= pagedata.name %><% } %></h3>
    <br>
    <% if(pagedata) { %><%= pagedata.description %><% } %>

<hr>
<h1>Client Project Items</h1>
<br>
<table border="2" cellspacing="5" cellpadding="5" style="width: 100%;">
<tr>
<th>Title</th>
<th>Number Of Projects</th>
<th>Edit</th>
<th>Remove</th>
</tr>
<% for(var item of expertiseitem) { %>
   <tr><td> 
      <%= item.name %>
      </td>
      <td> 
      <%= item.num %>
      </td>
       <td> 
      <a href="javascript:void(0)"  onclick="geteditform('<%= item._id %>')">Edit</a>
      </td> 
      <td> 
      <a href="/clientprojectremove/<%= item._id %>" onclick="return confirm('Are you sure you want to delete this item')">X</a>
      </td>
      </tr>
<% } %>
</table>
</div>
  <div class="col-md-4 form-wraper" style="display: none;" id="form-wrapper-form">
    <div id="clientmainform" style="display: none;">
     <h3><%= title %></h3>
     <form method="POST" action="/clientproject" class="common-form">
      <label>Title:<input type="text" name="title" required></label>
      <br>
      <label>Name:<input type="text" name="name" required></label>
      <br>
      <label>Description:<br><textarea name="description"></textarea></label>
      <br>
      <br>
      <input type="submit" value="Submit">
     </form>
   </div>

   <div id="clientprojectform" style="display: none;">
    <h3><%= title %> Item</h3>
        <form method="POST" action="/clientprojectitem" enctype="multipart/form-data">
          <label>Name:<input type="text" name="name" required></label>
          <br>
          <label>Number Of Project:<input type="text" name="num" required></label>
          <br>
          <input type="hidden" name="oldimage">
          <input type="file" name="userPhoto" id="userPhoto"  onchange="readURL(this);" placeholder=""  style="border:none;width:100%;" accept="image/*">
          <img id="clientprojectimage" src="/images/user.png" alt="your image" width="100px" height="100px"/>
          <br>
          <br>
          <input type="submit" value="Submit">
      </form>
  </div>

  <div id="csliderform" style="display: none;">
    <h3><%= title %> Slider</h3>
      <form method="POST" action="/addslideritem" enctype="multipart/form-data">
        <label>Name:<input type="text" name="name" required></label>
        <br>
        <label>Author:<input type="text" name="author" required></label>
        <br>
        <label>Video Url:<input type="text" name="videourl" required></label>
        <br>
        <label>Description:<input type="text" name="description" required></label>
        <br>
        <input type="hidden" name="oldimage" >
        <input type="file" name="clientPhoto"  onchange="readURL(this);" id="clientPhoto" placeholder=""  style="border:none;width:100%;" accept="image/*">
        <img id="clientsliderimage" src="/images/user.png" alt="your image" width="100px" height="100px"/>
        <br>
        <br>
        <input type="submit" value="Submit">
    </form>
  </div>

  <div id="edititemform" style="display: none;">
    <h3><%= title %> Update</h3>
    <form method="POST" action="/clientprojecteditajax" enctype="multipart/form-data">
       <input type="hidden" name="editid" id="editid"/>
       <label>Name:<input type="text" name="name" id="name" required></label>
       <br>
       <label>Number Of Project:<input type="text" name="num" id="projectnumber" required></label>
       <br>
       <input type="hidden" name="oldimage" id="oldfile">
       <input type="file" name="userPhoto" id="userPhotoupdate"  onchange="readURL(this);" placeholder=""  style="border:none;width:100%;" accept="image/*">
       <img id="clientimageupdate" src="/images/user.png" alt="your image" width="100px" height="100px"/>
       <br>
       <br>
      <input type="submit" value="Update">
  </form>
  </div>
 
 </div>
  </div>
</div> 
</section>

<script>
  $('#clientmainformbtn').click(function(){
    
      $('#form-wrapper-form').show();
      $('#clientmainform').toggle();
      $('#clientprojectform').hide();
      $('#csliderform').hide();
      $('#edititemform').hide();
      $('#userPhoto').val("");
      $('#clientPhoto').val("");
      $('#userPhotoupdate').val("");
      
  })
  $('#clientprojectformbtn').click(function(){
    
    $('#form-wrapper-form').show();
    $('#clientmainform').hide();
    $('#csliderform').hide();
    $('#clientprojectform').toggle();
    $('#edititemform').hide();
    $('#userPhoto').val("");
    $('#clientPhoto').val("");
    $('#userPhotoupdate').val("");
    $('#clientprojectimage').attr('src', '/images/user.png').width(100).height(100);
    $('#clientsliderimage').attr('src', '/images/user.png').width(100).height(100);
    
})
$('#csliderformbtn').click(function(){
    
    $('#form-wrapper-form').show();
    $('#csliderform').toggle();
    $('#clientmainform').hide();
    $('#clientprojectform').hide();
    $('#edititemform').hide();
    $('#userPhoto').val("");
    $('#clientPhoto').val("");
    $('#userPhotoupdate').val("");
    $('#clientprojectimage').attr('src', '/images/user.png').width(100).height(100);
    $('#clientsliderimage').attr('src', '/images/user.png').width(100).height(100);
    
})

function geteditform(editid){
 
 $.ajax({
 url:"/getclientprojectitem/"+editid,
 method:"GET",
 success: function(response){
 
    $('#userPhoto').val("");
    $('#userPhotoupdate').val("");
    $('#editid').val(editid);
    $('#name').val(response.name);
    $('#projectnumber').val(response.num);
    $('#oldfile').val(response.image);
    if(response.image != ''){
     $('#clientimageupdate').attr('src', response.image).width(100).height(100); 
    }else{
     $('#clientimageupdate').attr('src', '/images/user.png').width(100).height(100); 
    }
    $('#form-wrapper-form').show();
    $('#edititemform').show();
    $('#processplanform').hide();
    $('#clientmainform').hide();
    $('#csliderform').hide();
    $('#clientprojectform').hide();
    
   }
 });
 return false;
 }
 
function readURL(input) {
  if (input.files && input.files[0]) {
    var reader = new FileReader();
    //  alert(ftype);
    reader.onload = function (e) {
      $('#clientprojectimage').attr('src', e.target.result).width(100).height(100);
      $('#clientsliderimage').attr('src', e.target.result).width(100).height(100);
      $('#clientimageupdate').attr('src', e.target.result).width(100).height(100);
    };

    reader.readAsDataURL(input.files[0]);
  }
}

  </script>